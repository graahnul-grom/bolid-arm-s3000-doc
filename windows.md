# АРМ С3000: установка в ОС Windows



<!--
TODO Nginx => nginx

ORIG screens appearance order:
- typical install:
  - ports
  - pgsql
- advanced install:
  - comps
  - ports
  - pgsql
  - nginx
-->

<!--
NOTE:
- installer: pgsql 9.6
- installer: psqlODBC_x64: 13.02
- debian 12: pgsql 15.3
- 9.6 for win: not supported anymore
- s3k works OK with existing psql 16.0
- psql port: 5432 (/etc/services)
-->



## Введение

Руководство описывает установку службы (service) **s3k**
в ОС Windows и предназначено для системных администраторов.

Для работы службы требуются СУБД **pgsql** и web-сервер **nginx**
(входят в состав дистрибутива).

Опытные пользователи, запустив *выборочную* установку,
могут отключить эти компоненты и использовать **pgsql**
и/или **nginx**, уже установленные в системе.

Наличие подходящей версии **pgsql** определяется автоматически.
Для **nginx** необходимо указать путь к установленному серверу
и выполнить его настройку.



## Соглашения и условные обозначения

- **Полужирным** выделяются названия программных продуктов и аппаратных средств.
- *Курсив* применяется для обозначения технических терминов
  и в иных случаях для выделения частей текста.
- `Моноширинный шрифт` применяется для имен файлов, команд и их параметров,
  а также для примеров выполнения и вывода команд.
- **Примечание:** - краткие аннотации к основному тексту.



## Сокращения

- АРМ — автоматизированное рабочее место
- ОС — операционная система
- ПО — программное обеспечение
- СУБД — система управления базами данных



## Системные требования

- 64-разрядные Windows 8, 10, 11
- 64-разрядные Windows server 2012, 2012R, 2016, 2019, 2022



## Процесс установки

Дистрибутив **s3k** представляет собой исполняемый файл,
который следует запустить для начала установки. Запуск должен
осуществляться от имени *администратора* системы.

При запуске программы производится выбор метода установки:
полный или выборочный.

За исключением описанных ниже окон настройки, специфичных
для системы **s3k**, остальные являются стандартными
для программ такого рода и предлагают выполнить типичные
действия, такие, как просмотр и принятие лицензионного
соглашения, выбор языка, целевой папки и т.д.



### Окно выбора портов

В этом окне производится выбор и тестирование доступности сетевых
портов, используемых **s3k**.

![ports](ss_win/ports.png 'ports')

Для продолжения установки
необходимо
запустить
проверку
наличия свободных портов
нажатием на кнопку "Проверить порты".

При вводе в текстовое поле «Диапазон портов для модулей» номера
порта начала диапазона, второе поле (конец диапазона) заполняется
автоматически, в зависимости от числа модулей системы.

Порты для web-сервера **nginx** могут выбираться произвольно.

Отметив «Добавить порты в брандмауэр», можно указать программе
установки внести изменения в настройки сетевого экрана Windows,
разрешающие входящие соединения с сервером **nginx** на заданных
портах.

<!--
В этом окне производится выбор и проверка доступности сетевых
проверить
наличие свободных портов
нажатием на кнопку "Проверить порты".
прежде
протестировать
Без успешного тестирования
(нажатием на кнопку "Проверить порты")
продолжение установки невозможно.
-->


### Окно параметров PostgreSQL

Здесь задаются имя и пароль стандартной учетной записи СУБД **pgsql**.

![pgsql](ss_win/pgsql.png 'pgsql')

Если в ОС уже имеется сервер, совместимый с **s3k**,
система будет настроена для работы с ним, - **pgsql** из
состава дистрибутива не устанавливается. В окне будет
предложено задать дополнительные параметры:
сетевой *адрес* и *порт* для соединения с сервером.



### Окно выбора компонентов

При запуске *выборочной* установки, пользователь имеет возможность
указать, какие составляющие системы назначить для установки.

![comps](ss_win/comps.png 'comps')

Для выбора доступны следующие компоненты:
- Библиотеки C++
- СУБД PostgreSQL
- PostgreSQL ODBC
- Web-сервер Nginx

**Примечание:**<br />
При наличии в системе установленного сервера **pgsql**,
соответствующий пункт в списке будет недоступен.



### Окно параметров Nginx

Если **nginx** отсутствует среди выбранных компонентов,
программа установки предложит сообщить его расположение
в окне параметров Nginx.

![nginx](ss_win/nginx.png 'nginx')

В поле "Путь до корневой директории Nginx"
следует указать путь к папке, куда был установлен **nginx**.

Во втором поле задается путь к произвольной папке:
туда будет помещен файл с настройками **nginx**.
Он может служить заменой главному файлу конфигурации
**nginx**, `nginx.conf`.
Можно также модифицировать собственный `nginx.conf`,
используя параметры из этого файла.

**Примечание:**<br />
Созданный при установке файл `nginx.conf`
не предназначен для включения его с помощью
директивы `include` в существующий конфигурационный файл сервера.
В этом случае **s3k** работать не будет.



## Обновление и восстановление

При запуске программы установки на системе
с уже установленным **s3k**
будут предложены следующие действия:

![repair](ss_win/repair.png 'repair')

- Обновить:
  будут установлены заново только программные компоненты **s3k**,
  все данные (настройки, база данных) сохраняются неизменными.
- Исправить:
  система будет установлена заново, при этом настройки и другие
    данные
    перезаписываются
    и приводятся к своему первоначальному состоянию.
- Удалить:
  система **s3k** будет удалена с компьютера полностью.
<!--
    данные будут
    перезаписаны
    восстановлены
    приведены к первоначальному виду
    и приведены к первоначальному состоянию
    приводятся к виду
пользовательские данные (настройки, база данных) сохраняются неизменными.
-->


## Восстановление пароля пользователя admin

В случае утери пароля для встроенной учетной записи,
его восстановление возможно
с помощью запуска от имени *администратора* системы
пакетного файла (скрипта) `reset_pass.bat`.

Скрипт находится в папке установки **s3k**
(по умолчанию `C:\Bolid\ARM S3000 Service`).

Перед запуском нужно убедиться в том, что служба **s3k** работает.

В случае успешного сброса пароля скриптом будет выведено
сообщение "Пароль сброшен". Будет восстановлен стандартный
пароль - *armS3000*.

